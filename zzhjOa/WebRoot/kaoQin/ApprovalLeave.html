<!DOCTYPE html>
<html lang="en">
<head>
    <title>瀹� 鎵� 璇� 鍋� 淇� 鎭�</title>
</head>
<body>
<div id="buttonBarLeave">
    <a  class="easyui-linkbutton" iconCls="icon-grxx" plain="true" onclick="approvalLeaveDIG()">瀹℃壒璇峰亣</a>
</div>
<table id="approvalLeaveDG"></table>
<div id="LeaverDIG" class=" easyui-dialog TGK" closed=true title="鏌ョ湅璇峰亣/浼戝亣璇︽儏">
    <ul>
        <li>
            <input type="text" hidden id="approvalID">
        </li>
        <li>
            <span>璇峰亣浜�</span>
            <input type="text" name="LeuserId" readonly />
        </li>
        <li>
            <span>璇峰亣绫诲瀷</span>
            <input type="text" name="LerestTypeId" readonly />
        </li>

        <li>
            <span>璇峰亣璧峰鏃堕棿</span>
            <input type="text" name="LecurrentDate" style="width: 250px" readonly/>
            <input type="text" name="LestarTime" style="width: 70px;height: 40px;margin-left: 20px;" readonly/>
        </li>
        <li>
            <span>璇峰亣缁撴潫鏃堕棿</span>
            <input type="text" name="LecurrentOverDate" style="width: 250px" readonly />
            <input type="text" name="LeoverTime"   style="width: 70px;height: 40px;margin-left: 20px;"  readonly />

        </li>
        <li>
            <span>璇峰亣澶╂暟</span>
            <input type="text" name="LerestDate"     readonly   />
        </li>
        <li>
            <span style="float: left;">璇峰亣鍘熺敱</span>
            <textarea name="LerestText" rows="3" cols="30" style="width: 348px" readonly></textarea>
        </li>
        <li id="FileLi" style="height: 0;overflow: hidden;min-height: 0">
            <span style="float: left;">闄勪欢</span>
            <a id="LeFile" href="" download=""  target="_blank">涓嬭浇闄勪欢</a>
        </li>
        <li style="margin-bottom: 30px">
            <input  type="button" value="瀹� 鎵�" onclick="approvalLeave()"  class="button-task"/>
        </li>
    </ul>
</div>
<script type="text/javascript">
    $('#approvalLeaveDG').datagrid({
        url:'',
        fitColumns:true,
        toolbar: '#buttonBarLeave',
        pagination:true,
        singleSelect:true,
        columns:[[
            {field:'id',title:'缂栧彿',checkbox:true,width:200},
            {field:'userId',title:'璇峰亣浜�',width:200,formatter:function(value){return value.name}},
            {field:'restTypeId',title:'璇峰亣绫诲瀷',formatter: function(value){return value.name;},width:100},
            {field:'restText',title:'璇峰亣鍘熺敱',width:400},
            {field:'requestDate',title:'璇峰亣璧峰鏃堕棿'},
            {field:'requestStage',title:'寮�濮嬮樁娈�'},
            {field:'overDate',title:'璇峰亣缁撴潫鏃堕棿'},
            {field:'overStage',title:'缁撴潫闃舵'},
            {field:'restDate',title:'璇峰亣澶╂暟'},
            {field:'approver',title:'瀹℃壒浜�'},
            {field:'state',title:'鐘舵��'},
            {field:'appendix',title:'闄勪欢',hidden:true}
        ]]
    });

//    鐢宠璇︽儏寮圭獥
    function approvalLeaveDIG(){
        var row=$('#approvalLeaveDG').datagrid('getSelected');
        if(row){
            $("#LeaverDIG").dialog({
                title : '璇峰亣淇℃伅',
//				width : 400,
//            height : 550,
                top:50,
                closed : false,
                cache : false,
                modal : true,
                onOpen:function(){
                    $("#approvalID").val(row.id);
                    $("input[name = LeuserId]").val(row.userId.name);
                    $("input[name = LerestTypeId]").val(row.restTypeId.name);
                    $("input[name = LecurrentDate]").val(row.requestDate);
                    $("input[name = LestarTime]").val(row.requestStage);
                    $("input[name = LecurrentOverDate]").val(row.overDate);
                    $("input[name = LeoverTime]").val(row.overStage);
                    $("input[name = LerestDate]").val(row.restDate);
                    $("input[name = LerestText]").val(row.restText);
                    if(row.appendix!=""){
                        $("#FileLi").css({"height":"40px"});
                        $("#LeFile").attr("href",row.appendix);
                    }
                }
            });
        }else{
            $.messager.alert("鎻愮ず","璇峰厛閫変腑涓�鏉＄敵璇蜂俊鎭紒","info")
        }
    }
//    缁欎簣閫氳繃
    function approvalLeave(){
            $.post('',{'id': $("#approvalID").val()},function(data){
                if(data!=null&&data>0){
                    $("#approvalLeaveDG").datagrid('reload');
                    $.messager.alert("鎻愮ず", "瀹℃壒鎴愬姛锛�", "info");
                }else{
                    $.messager.alert("鎻愮ず", "瀹℃壒澶辫触锛岃绋嶅�欓噸璇曪紒", "info");
                }
            })
    }


</script>
</body>
</html>