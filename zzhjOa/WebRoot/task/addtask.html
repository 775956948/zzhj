<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>添加任务信息</title>

</head>
<body>
<div class="PagingBody">
    <div class="inputDivZT">
        <div class="inputDiv">
            <span>任务主题:</span>
            <input type="text" name="taskTheme" title="任务主题">
            <span>任务内容:</span>
            <textarea rows="6" cols="30"  name="taskContent" id="taskContent" ></textarea>
            <span>任务天数:</span>
            <input type="number" name="taskDays">
            <span>任务接收人:</span>
            <select name="taskReceive" style="margin: 0 auto;display: block"></select>
            <button id="submitTask">确  认  发  布</button>
        </div>
    </div>
    <h3>添加任务信息</h3>
</div>


<script type="text/javascript">
    $.ajax({
        url:'users/querySubclass.action',
        type:'POST',
        async:false,
        success:function(data){
        	 $("select[name='taskReceive']").empty();
            for(var i=0;i<data.length;i++){
                $("select[name='taskReceive']").append("<option>"+data[i]+"</option>")
            }
        }
    });

    $(function(){
    	
        var submitTask=$("#submitTask");
        submitTask.click(function(){
            var taskTheme=$("input[name='taskTheme']").val();
            var taskContent=$("#taskContent").val();
            var taskDays=$("input[name='taskDays']").val();
            var taskReceive=$("select[name='taskReceive']").find("option:selected").text();
            if(taskDays!=""&&taskContent!=""&&taskTheme!=""){
                $.ajax({
                    url:'task/addTask.action',
                    type:'POST',
                    async:false,
                    data:{
                        taskTheme:taskTheme,
                        taskText:taskContent,
                        taskDay:taskDays,
                        recipient:taskReceive
                    },
                    success:function(data){
                    	if(data>0){
                    		 $.messager.alert("提示","发布成功","info")
                    	}
                    	$(".inputDiv input,textarea").val("");
                       
                    },
                    error:function(){
                        $.messager.alert("错误","发布失败","info")
                    }
                })
            }else{
                $.messager.alert("提示","请填写完整信息", "info");
            } 
        })

    })

</script>
</body>
</html>